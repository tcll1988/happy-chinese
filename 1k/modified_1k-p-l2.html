<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒŸãƒ‹ç·´ç¿’ - ä¸¦ã³æ›¿ãˆç·´ç¿’</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    .container {
      max-width: 800px;
      margin: 40px auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    h1 {
      color: #333333;
      margin-bottom: 20px;
    }
    .hint {
      font-size: 16px;
      color: #555;
      margin-bottom: 20px;
      animation: fadeIn 1s ease-in-out;
    }
    .scrambled-words {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .scrambled-words button {
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
    }
    .scrambled-words button:hover {
      background-color: #45a049;
      transform: scale(1.1);
    }
    .scrambled-words button:disabled {
      background-color: #aaa;
      cursor: not-allowed;
      transform: scale(1);
    }
    .answer-area {
      min-height: 50px;
      padding: 10px;
      border: 2px dashed #ccc;
      margin-bottom: 20px;
      font-size: 18px;
      background-color: #fafafa;
      text-align: center;
      animation: slideUp 0.5s ease-in-out;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .controls button {
      padding: 8px 12px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #008CBA;
      color: white;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
    }
    .controls button:hover {
      background-color: #007bb5;
      transform: scale(1.1);
    }
    .result {
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 20px;
      animation: fadeIn 1s ease-in-out;
    }
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
    .encouragement {
      font-size: 20px;
      color: #4CAF50;
      font-weight: bold;
      margin-bottom: 20px;
      animation: fadeIn 1s ease-in-out;
    }
    .fireworks {
      position: relative;
      width: 100%;
      height: 200px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .firework {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #ff4d4d;
      border-radius: 50%;
      animation: explode 1s ease-out forwards;
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    @keyframes slideUp {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    @keyframes explode {
      0% {
        transform: scale(1);
        opacity: 1;
      }
      100% {
        transform: scale(5);
        opacity: 0;
      }
    }
    @media (max-width: 600px) {
      .scrambled-words button {
        font-size: 14px;
        padding: 8px 12px;
      }
      .answer-area {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ãƒŸãƒ‹ç·´ç¿’ - ä¸¦ã³æ›¿ãˆç·´ç¿’</h1>
    <div class="exercise" id="currentExercise">
      <!-- æ—¥è¯­æç¤º -->
      <p class="hint" id="hint">ã€Œæ—¥æœ¬èªã®æ„å‘³ã€ã«å¾“ã£ã¦æ­£ã—ã„é †ç•ªã«ä¸¦ã¹æ›¿ãˆã¾ã—ã‚‡ã†ã€‚</p>
      <!-- å•è¯æŒ‰é’® -->
      <div class="scrambled-words" id="scrambledWords"></div>
      <!-- ç­”æ¡ˆåŒºåŸŸ -->
      <div class="answer-area" id="answerArea"></div>
      <!-- æ“ä½œæŒ‰é’® -->
      <div class="controls">
        <button id="checkButton" onclick="checkAnswer()">ç¢ºèª</button>
        <button id="nextButton" onclick="initExercise()" style="display: none;">æ¬¡ã®å•é¡Œã¸</button>
        <button id="resetButton" onclick="resetExercise()" style="display: none;">å†ä¸€æ¬¡</button>
        <a id="returnButton" href="ä¿®æ”¹.html" style="display: none;">
          <button>æˆ»ã‚‹</button>
        </a>
      </div>
      <!-- ç»“æœæ˜¾ç¤º -->
      <div class="result" id="result"></div>
      <!-- é¼“åŠ±è¯­ -->
      <div class="encouragement" id="encouragement"></div>
      <!-- çƒŸèŠ±åŠ¨ç”» -->
      <div class="fireworks" id="fireworks"></div>
    </div>
  </div>
  <script>
    // ç»ƒä¹ æ•°æ®
    const exercises = [
      {
        words: ["ç•™å­¦ç”Ÿ", "æä¼˜", "æ˜¯", "æˆ‘", "å«", "ï¼Œ", "ã€‚"],
        correctAnswer: "æˆ‘æ˜¯ç•™å­¦ç”Ÿï¼Œå«æä¼˜ã€‚",
        hint: "æ­£ã—ã„æ–‡ã¯ã€Œç§ã¯ç•™å­¦ç”Ÿã§ã€æå„ªã¨è¨€ã„ã¾ã™ã€‚ã€"
      },
      {
        words: ["æˆ‘", "æ—¥æ–‡", "å­¦ä¹ ", "å­¦ä¹ ", "ä¸­æ–‡", "å±±æœ¬", "ï¼Œ", "ã€‚"],
        correctAnswer: "æˆ‘å­¦ä¹ æ—¥æ–‡ï¼Œå±±æœ¬å­¦ä¹ ä¸­æ–‡ã€‚",
        hint: "æ­£ã—ã„æ–‡ã¯ã€Œç§ã¯æ—¥æœ¬èªã‚’å‹‰å¼·ã—ã€å±±æœ¬ã•ã‚“ã¯ä¸­å›½èªã‚’å‹‰å¼·ã—ã¾ã™ã€‚ã€"
      }
    ];

    let currentExerciseIndex = -1;
    let selectedWords = [];
    let completedExercises = [];

    // é¼“åŠ±è¯­åˆ—è¡¨
    const encouragementMessages = [
      "ç´ æ™´ã‚‰ã—ã„ï¼æ¬¡ã®å•é¡Œã«é€²ã¿ã¾ã—ã‚‡ã†ï¼",
      "ã‚ˆãã§ãã¾ã—ãŸï¼ç¶šã‘ã¦é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼",
      "å®Œç’§ã§ã™ï¼æ¬¡ã®æŒ‘æˆ¦ã«å‚™ãˆã¾ã—ã‚‡ã†ï¼"
    ];

    // éšæœºç”ŸæˆçƒŸèŠ±
    function createFireworks() {
      const fireworksContainer = document.getElementById('fireworks');
      for (let i = 0; i < 20; i++) {
        const firework = document.createElement('div');
        firework.classList.add('firework');
        firework.style.left = `${Math.random() * 100}%`;
        firework.style.top = `${Math.random() * 100}%`;
        firework.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
        fireworksContainer.appendChild(firework);
      }
      setTimeout(() => {
        fireworksContainer.innerHTML = "";
      }, 1000);
    }

    // åˆå§‹åŒ–ç»ƒä¹ 
    function initExercise() {
      // å¦‚æœæ‰€æœ‰é¢˜ç›®éƒ½å·²å®Œæˆ
      if (completedExercises.length === exercises.length) {
        document.getElementById('encouragement').textContent = "å…¨å•æ­£è§£ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ‰";
        createFireworks();
        document.getElementById('returnButton').style.display = "inline-block";
        return;
      }

      // éšæœºé€‰æ‹©ä¸€é“æœªå®Œæˆçš„é¢˜
      do {
        currentExerciseIndex = Math.floor(Math.random() * exercises.length);
      } while (completedExercises.includes(currentExerciseIndex));

      const exercise = exercises[currentExerciseIndex];

      // æ¸…ç©ºç•Œé¢
      document.getElementById('scrambledWords').innerHTML = "";
      document.getElementById('answerArea').textContent = "";
      document.getElementById('result').textContent = "";
      document.getElementById('encouragement').textContent = "";
      document.getElementById('checkButton').style.display = "inline-block";
      document.getElementById('nextButton').style.display = "none";
      document.getElementById('resetButton').style.display = "none";

      // æ˜¾ç¤ºé—®é¢˜å’Œæç¤º
      document.getElementById('hint').textContent = exercise.hint;

      // æ‰“ä¹±å•è¯é¡ºåºå¹¶ç”ŸæˆæŒ‰é’®
      const shuffledWords = shuffleArray(exercise.words.slice());
      shuffledWords.forEach(word => {
        const btn = document.createElement('button');
        btn.textContent = word;
        btn.setAttribute('data-word', word);
        btn.onclick = function() {
          addWord(word, btn);
        };
        document.getElementById('scrambledWords').appendChild(btn);
      });

      selectedWords = [];
    }

    // æ´—ç‰Œå‡½æ•°
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // æ·»åŠ å•è¯åˆ°ç­”æ¡ˆåŒºåŸŸ
    function addWord(word, btn) {
      selectedWords.push(word);
      document.getElementById('answerArea').textContent = selectedWords.join("");
      btn.disabled = true;
      btn.style.backgroundColor = "#aaa";
    }

    // æ£€æŸ¥ç­”æ¡ˆ
    function checkAnswer() {
      const userAnswer = selectedWords.join("").replace(/[ï¼Œã€‚]/g, ""); // å¿½ç•¥æ ‡ç‚¹ç¬¦å·
      const correctAnswer = exercises[currentExerciseIndex].correctAnswer.replace(/[ï¼Œã€‚]/g, "");

      // å¦‚æœç”¨æˆ·æ²¡æœ‰ä½œç­”
      if (userAnswer.trim() === "") {
        document.getElementById('result').textContent = "ã¾ã è§£ç­”ã—ã¦ã„ã¾ã›ã‚“ã€‚ã¾ãšã¯å˜èªã‚’é¸ã‚“ã§ãã ã•ã„ï¼";
        document.getElementById('result').classList.remove('correct');
        document.getElementById('result').classList.add('incorrect');
        return;
      }

      if (userAnswer === correctAnswer) {
        // æ˜¾ç¤ºéšæœºé¼“åŠ±è¯­
        const randomMessage = encouragementMessages[Math.floor(Math.random() * encouragementMessages.length)];
        document.getElementById('encouragement').textContent = randomMessage;

        // æ ‡è®°å½“å‰é¢˜ç›®ä¸ºå·²å®Œæˆ
        completedExercises.push(currentExerciseIndex);

        // å¦‚æœè¿˜æœ‰æœªå®Œæˆçš„é¢˜ç›®
        if (completedExercises.length < exercises.length) {
          document.getElementById('checkButton').style.display = "none";
          document.getElementById('nextButton').style.display = "inline-block";
        } else {
          // å¦‚æœæ‰€æœ‰é¢˜ç›®éƒ½å·²å®Œæˆ
          document.getElementById('encouragement').textContent = "å…¨å•æ­£è§£ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ‰";
          createFireworks();
          document.getElementById('returnButton').style.display = "inline-block";
        }
      } else {
        document.getElementById('result').textContent = `ä¸æ­£è§£ã§ã™ã€‚æ­£ã—ã„ç­”ãˆã¯ã€Œ${exercises[currentExerciseIndex].correctAnswer}ã€ã§ã™ã€‚`;
        document.getElementById('result').classList.add('incorrect');
        document.getElementById('checkButton').style.display = "none";
        document.getElementById('resetButton').style.display = "inline-block";
      }
    }

    // é‡ç½®ç»ƒä¹ 
    function resetExercise() {
      initExercise();
    }

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    window.onload = function() {
      initExercise();
    };
  </script>
</body>
</html>