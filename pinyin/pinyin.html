<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>中国語ピンイン</title>
  <style>
    /* グローバルスタイル */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }
    .content {
      padding: 20px;
      flex: 1;
    }
    .page {
      display: none;
      animation: fadeIn 0.5s ease-out;
    }
    .active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      margin: 10px auto;
      padding: 15px;
      max-width: 600px;
      transition: transform 0.3s;
    }
    .card:hover {
      transform: scale(1.02);
    }
    button {
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      margin: 5px;
    }
    button:hover {
      transform: scale(1.05);
    }
    .nav-btn {
      background-color: #00796b;
      color: #fff;
      width: 100%;
      margin: 5px 0;
    }
    .back {
      background-color: #0097a7;
      color: #fff;
      position: fixed;
      left: 15px;
      top: 20px;
      font-size: 0.9em;
      padding: 8px 12px;
      border-radius: 5px;
      z-index: 1100;
    }
    .pinyin-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    .pinyin {
      background-color: #f8bbd0;
      padding: 10px 15px;
      border-radius: 50px;
      border: 2px solid #ad1457;
      cursor: pointer;
      font-size: 1.2em;
      transition: background-color 0.3s, transform 0.2s;
      text-align: center;
    }
    .pinyin:hover {
      background-color: #ad1457;
      color: #fff;
      transform: scale(1.1);
    }
    /* Summary用セルのスタイル */
    #pinyinSummaryBody .pinyin {
      font-size: 1.5em;
      font-weight: bold;
      background-color: #fff3e0;
      border: 2px solid #ff6f00;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      transition: transform 0.2s, background-color 0.3s;
      display: inline-block;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    #pinyinSummaryBody .pinyin:hover {
      background-color: #ffcc80;
      transform: scale(1.2);
    }
    .quiz-section {
      text-align: center;
      border-top: 1px dashed #ccc;
      margin-top: 20px;
      padding-top: 15px;
    }
    .quiz-section h3 {
      margin-bottom: 5px;
    }
    .quiz-instructions {
      font-size: 0.9em;
      color: #555;
      margin-bottom: 10px;
    }
    .quiz-section button {
      background-color: #4caf50;
      color: #fff;
    }
    .quiz-options button {
      background-color: #e1bee7;
      border: 2px solid #6a1b9a;
      border-radius: 5px;
      margin: 5px;
      padding: 10px;
      min-width: 60px;
    }
    .quiz-options button:hover {
      background-color: #6a1b9a;
      color: #fff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
      margin-top: 15px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 10px;
    }
    .category-header {
      background-color: #00796b;
      color: #fff;
      font-weight: bold;
      text-align: center;
      animation: fadeInColor 2s infinite alternate;
    }
    @keyframes fadeInColor {
      from { background-color: #00796b; }
      to { background-color: #004d40; }
    }
    .explanation {
      background-color: #fffcaa;
      padding: 10px;
      border-left: 5px solid #fdd835;
      font-weight: bold;
      margin: 10px 0;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { background-color: #fffcaa; }
      50% { background-color: #fff59d; }
      100% { background-color: #fffcaa; }
    }
    .play-button {
      display: inline-block;
      margin-left: 10px;
      padding: 5px 10px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }
    .play-button:hover {
      background-color: #43a047;
    }
    footer {
      text-align: center;
      padding: 10px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 0.8em;
    }
  </style>
</head>
<body>
  <div class="content">
    <!-- ホーム画面 -->
    <div id="home" class="page active">
      <div class="card">
        <h2>中国語のピンイン</h2>
        <button class="nav-btn" onclick="showSection('section1')">1. 単母音（基本の母音）</button>
        <button class="nav-btn" onclick="showSection('section2')">2. 複母音</button>
        <button class="nav-btn" onclick="showSection('section3')">3. 子音（その１）</button>
        <button class="nav-btn" onclick="showSection('section4')">4. 声調の変化</button>
        <button class="nav-btn" onclick="showSection('section5')">5. 子音（その２）</button>
        <button class="nav-btn" onclick="showSection('section6')">6. 鼻母音</button>
        <button class="nav-btn" onclick="showSection('section7')">7. 声調の変化（例）</button>
        <button class="nav-btn" onclick="showSection('section8')">8. 声調符号の付け方</button>
        <button class="nav-btn" onclick="showSection('section9')">9. 儿化</button>
        <button class="nav-btn" onclick="showSection('section10')">10. 隔音符号</button>
        <button class="nav-btn" onclick="showSection('section11')">11. ピンインのまとめ</button>
<a class="back-link" href="../happy.html" style="display: block; width: fit-content; margin: 20px auto; padding: 10px 20px; background-color: #00796b; color: #fff; text-align: center; border-radius: 5px; text-decoration: none;">戻る</a>
 </div>
    </div>
    
    <!-- Section 1: 単母音 -->
    <div id="section1" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>1. 単母音（基本の母音）</h2>
        <p>
          a：日本語の「あ」に似ていますが、口を大きく開けて発音します。<br>
          o：口を丸くして、後ろで発音します。<br>
          e：舌の根元を少し後ろに引いて発音します。<br>
          i：日本語の「い」に似ています。<br>
          u：日本語の「う」と似ていますが、唇を丸くして前に出して発音します。<br>
          ü：まず「u」の口形を作り、その状態で「i」と発音します。
        </p>
        <p class="explanation">説明: 母音は中国語発音の基本です。口の開き具合や舌の位置を意識して、ゆっくり正確に練習してください。</p>
        <div class="pinyin-list">
          <span class="pinyin" data-sound="a">a</span>
          <span class="pinyin" data-sound="o">o</span>
          <span class="pinyin" data-sound="e">e</span>
          <span class="pinyin" data-sound="i">i</span>
          <span class="pinyin" data-sound="u">u</span>
          <span class="pinyin" data-sound="v">ü</span>
        </div>
        <div class="quiz-section">
          <h3>発音練習クイズ</h3>
          <p class="quiz-instructions">使用説明: 再生ボタンを押して音声を聴き、正しい拼音を選んでください。</p>
          <button class="play-quiz-btn" onclick="startQuiz(false)">再生</button>
          <div class="quiz-options"></div>
          <p class="quiz-result"></p>
        </div>
      </div>
    </div>
    
    <!-- Section 2: 複母音 -->
    <div id="section2" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>2. 複母音（二つ以上の母音の組み合わせ）</h2>
        <p>
          ai, ei, ao, ou, ia（ya）、ie（ye）、ua（wa）、uo（wo）、<br>
          üe（yue）、iao（yao）、iou（you）、uai（wai）、uei（wei）、er
        </p>
        <p class="explanation">説明: 複母音は複数の母音が連続して発音されます。各母音の切り替えに注意し、滑らかに発音できるよう練習してください。</p>
        <div class="pinyin-list">
          <span class="pinyin" data-sound="ai">ai</span>
          <span class="pinyin" data-sound="ei">ei</span>
          <span class="pinyin" data-sound="ao">ao</span>
          <span class="pinyin" data-sound="ou">ou</span>
          <span class="pinyin" data-sound="ia">ia</span>
          <span class="pinyin" data-sound="ie">ie</span>
          <span class="pinyin" data-sound="ua">ua</span>
          <span class="pinyin" data-sound="uo">uo</span>
          <span class="pinyin" data-sound="ve">üe</span>
          <span class="pinyin" data-sound="iao">iao</span>
          <span class="pinyin" data-sound="iou">iou</span>
          <span class="pinyin" data-sound="uai">uai</span>
          <span class="pinyin" data-sound="uei">uei</span>
          <span class="pinyin" data-sound="er">er</span>
        </div>
        <div class="quiz-section">
          <h3>発音練習クイズ</h3>
          <p class="quiz-instructions">使用説明: 再生ボタンを押して音声を聴き、正しい拼音を選んでください。</p>
          <button class="play-quiz-btn" onclick="startQuiz(false)">再生</button>
          <div class="quiz-options"></div>
          <p class="quiz-result"></p>
        </div>
      </div>
    </div>
    
    <!-- Section 3: 子音（その１） -->
    <div id="section3" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>3. 子音（その１）</h2>
        <p>
          b(o), p(o), m(o), f(o), d(e), t(e), n(e), l(e), g(e), k(e), h(o)
        </p>
        <p class="explanation">説明: 基本の子音は発音の土台です。正しい口の形と発声方法を確認しながら練習してください。</p>
        <div class="pinyin-list">
          <span class="pinyin" data-sound="b">b</span>
          <span class="pinyin" data-sound="p">p</span>
          <span class="pinyin" data-sound="m">m</span>
          <span class="pinyin" data-sound="f">f</span>
          <span class="pinyin" data-sound="d">d</span>
          <span class="pinyin" data-sound="t">t</span>
          <span class="pinyin" data-sound="n">n</span>
          <span class="pinyin" data-sound="l">l</span>
          <span class="pinyin" data-sound="g">g</span>
          <span class="pinyin" data-sound="k">k</span>
          <span class="pinyin" data-sound="h">h</span>
        </div>
        <div class="quiz-section">
          <h3>発音練習クイズ</h3>
          <p class="quiz-instructions">使用説明: 再生ボタンを押して音声を聴き、正しい拼音を選んでください。</p>
          <button class="play-quiz-btn" onclick="startQuiz(false)">再生</button>
          <div class="quiz-options"></div>
          <p class="quiz-result"></p>
        </div>
      </div>
    </div>
    
    <!-- Section 4: 声調の変化（例の追加） -->
    <div id="section4" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>4. 声調の変化</h2>
        <p>
          <strong>第三声の変調</strong><br>
          中国語の二つの第三声の音節が連続すると、最初の音節は通常第二声に発音する。<br>
          例：nǐ　hǎo → ní　hǎo<br><br>
          <strong>「一」の変調</strong><br>
          数を数える場合：第一声を保つ。例：「一」（yī） 
          <button class="play-button" onclick="playSound('yi')">再生</button><br>
          「一」+第四声＝「yí」　例：「一半」（yí bàn） 
          <button class="play-button" onclick="playSound('yiban')">再生</button><br>
          「一」+第一声、第二声、第三声＝「yì」　例：「一起」（yì qǐ） 
          <button class="play-button" onclick="playSound('yiqi')">再生</button><br><br>
          <strong>「不」の変調</strong><br>
          「不」+第四声＝「bú」　例：「不是」（bú shì） 
          <button class="play-button" onclick="playSound('bushi')">再生</button>
        </p>
        <p class="explanation">説明: 連続する声調の変化や、「一」「不」の変調は中国語発音の重要ルールです。しっかり理解し、反復練習しましょう。</p>
      </div>
    </div>
    
    <!-- Section 5: 子音（その２） -->
    <div id="section5" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>5. 子音（その２）</h2>
        <p>
          j(i), q(i), x(i), z(i), c(i), s(i), zh(i), ch(i), sh(i), r(i)
        </p>
        <p class="explanation">説明: 子音の細かい発音に慣れるため、口の形と舌の位置をしっかり意識して、丁寧に練習してください。</p>
        <div class="pinyin-list">
          <span class="pinyin" data-sound="j">j</span>
          <span class="pinyin" data-sound="q">q</span>
          <span class="pinyin" data-sound="x">x</span>
          <span class="pinyin" data-sound="z">z</span>
          <span class="pinyin" data-sound="c">c</span>
          <span class="pinyin" data-sound="s">s</span>
          <span class="pinyin" data-sound="zh">zh</span>
          <span class="pinyin" data-sound="ch">ch</span>
          <span class="pinyin" data-sound="sh">sh</span>
          <span class="pinyin" data-sound="r">r</span>
        </div>
        <div class="quiz-section">
          <h3>発音練習クイズ</h3>
          <p class="quiz-instructions">使用説明: 再生ボタンを押して音声を聴き、正しい拼音を選んでください。</p>
          <button class="play-quiz-btn" onclick="startQuiz(false)">再生</button>
          <div class="quiz-options"></div>
          <p class="quiz-result"></p>
        </div>
      </div>
    </div>
    
    <!-- Section 6: 鼻母音 -->
    <div id="section6" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>6. 鼻母音（鼻にかかる音）</h2>
        <p>
          前鼻母音（-n 終わり）：an, en, ian, in, uan（wan）、uen（wen）、üan（yuan）、ün（yun）<br>
          後鼻母音（-ng 終わり）：ang, eng, ing, ong, uang（wang）、ueng（weng）、iang, iong（yong）
        </p>
        <p class="explanation">説明: 鼻母音は鼻腔を通る発音です。鼻にかかる感覚をしっかりつかみ、正確な発音を目指して練習してください。</p>
        <div class="pinyin-list">
          <span class="pinyin" data-sound="an">an</span>
          <span class="pinyin" data-sound="en">en</span>
          <span class="pinyin" data-sound="ian">ian</span>
          <span class="pinyin" data-sound="in">in</span>
          <span class="pinyin" data-sound="uan">uan</span>
          <span class="pinyin" data-sound="uen">uen</span>
          <span class="pinyin" data-sound="ve">üan</span>
          <span class="pinyin" data-sound="vn">ün</span>
          <span class="pinyin" data-sound="ang">ang</span>
          <span class="pinyin" data-sound="eng">eng</span>
          <span class="pinyin" data-sound="ing">ing</span>
          <span class="pinyin" data-sound="ong">ong</span>
          <span class="pinyin" data-sound="uang">uang</span>
          <span class="pinyin" data-sound="ueng">ueng</span>
          <span class="pinyin" data-sound="iang">iang</span>
          <span class="pinyin" data-sound="iong">iong</span>
        </div>
        <div class="quiz-section">
          <h3>発音練習クイズ</h3>
          <p class="quiz-instructions">使用説明: 再生ボタンを押して音声を聴き、正しい拼音を選んでください。</p>
          <button class="play-quiz-btn" onclick="startQuiz(false)">再生</button>
          <div class="quiz-options"></div>
          <p class="quiz-result"></p>
        </div>
      </div>
    </div>
    
    <!-- Section 7: 声調の変化（例の追加） -->
    <div id="section7" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>7. 声調の変化</h2>
        <p>
          <strong>第三声の変調</strong><br>
          中国語の二つの第三声の音節が連続すると、最初の音節は通常第二声に発音する。<br>
          例：nǐ　hǎo → ní　hǎo<br><br>
          <strong>「一」の変調</strong><br>
          数を数える場合：第一声を保つ。例：「一」（yī）　
          <button class="play-button" onclick="playSound('yi')">再生</button><br>
          「一」+第四声＝「yí」　例：「一半」（yí bàn）　
          <button class="play-button" onclick="playSound('yiban')">再生</button><br>
          「一」+第一声、第二声、第三声＝「yì」　例：「一起」（yì qǐ）　
          <button class="play-button" onclick="playSound('yiqi')">再生</button><br><br>
          <strong>「不」の変調</strong><br>
          「不」+第四声＝「bú」　例：「不是」（bú shì）　
          <button class="play-button" onclick="playSound('bushi')">再生</button>
        </p>
        <p class="explanation">説明: 連続する声調の変化や、「一」「不」の変調は中国語発音の重要ルールです。しっかり理解し、反復練習しましょう。</p>
      </div>
    </div>
    
    <!-- Section 8: 声調符号の付け方（クイズ削除） -->
    <div id="section8" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>8. 声調符号の付け方</h2>
        <p>
          下記の順で母音の上に声調符号を付ける。<br>
          a ⇒ o ⇒ e ⇒ i ⇒ u ⇒ ü<br>
          例：dǎn shòu<br>
          特例：ui と iu は後ろの母音に付ける。例：liù huì<br>
          軽声：付ける必要なし
        </p>
        <p class="explanation">説明: 発音と文字の対応を理解するため、符号の付け方をしっかり確認してください。</p>
      </div>
    </div>
    
    <!-- Section 9: 儿化（ｒ）の説明（クイズ削除） -->
    <div id="section9" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>9. 儿化</h2>
        <p>
          “儿化”とは、単語の末尾に「儿」を付けて発音する現象で、北京方言でよく見られる。<br>
          例：花儿（huāer）→ 花　
          <button class="play-button" onclick="playSound('huar')">再生</button><br>
          例：门儿（méner）→ 門　
          <button class="play-button" onclick="playSound('menr')">再生</button>
        </p>
        <p class="explanation">説明: 末尾の「儿」を付ける際のリズムと発音を意識して練習してください。</p>
      </div>
    </div>
    
    <!-- Section 10: 隔音符号（'）の説明（クイズ削除） -->
    <div id="section10" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>10. 隔音符号（区切り記号）</h2>
        <p>
          “a”、“o”、“e”で始まる音節の前に他の音節が来る場合、隔音符号（'）を入れて二つの音節を明確に分ける。<br>
          例：xī'ān（西安）　
          <button class="play-button" onclick="playSound('xi,an')">再生</button><br>
          と xiān（先）　
          <button class="play-button" onclick="playSound('xian')">再生</button>
        </p>
        <p class="explanation">説明: 正しい区切りを把握することで、発音の流れが理解しやすくなります。</p>
      </div>
    </div>
    
    <!-- Section 11: ピンインのまとめ（カテゴリ別） -->
    <div id="section11" class="page">
      <button class="back" onclick="backHome()">戻る</button>
      <div class="card">
        <h2>11. ピンインのまとめ</h2>
        <p class="explanation">説明: 以下はこれまで学んだピンインを「単母音」「複母音」「子音」「鼻母音」「声調」の5カテゴリに分類したものです。</p>
        <table id="pinyinSummaryTable">
          <tbody id="pinyinSummaryBody">
            <!-- JavaScriptで内容を生成 -->
          </tbody>
        </table>
      </div>
    </div>
    
  </div>
  <footer>
    楽しい中国語
  </footer>
  
  <script>
    // 各単元のクイズ用データ（単元ごとに対象のピンイン）
    const unitQuizData = {
      "section1": ["a", "o", "e", "i", "u", "v"],
      "section2": ["ai", "ei", "ao", "ou", "ia", "ie", "ua", "uo", "ve", "iao", "iou", "uai", "uei", "er"],
      "section3": ["b", "p", "m", "f", "d", "t", "n", "l", "g", "k", "h"],
      "section4": ["mā", "má", "mǎ", "mà"],
      "section5": ["j", "q", "x", "z", "c", "s", "zh", "ch", "sh", "r"],
      "section6": ["an", "en", "ian", "in", "uan", "uen", "van", "vn", "ang", "eng", "ing", "ong", "uang", "ueng", "iang", "iong"],
      "section7": ["nǐ", "hǎo"],
      "section8": ["dǎn", "shòu"],
      "section9": ["huāer", "méner"],
      "section10": ["xī'ān", "xiān"]
    };
    
    // ピンインのまとめ用カテゴリ（使用するのは：section1, section2, section3+section5, section6, section4）
    const summaryCategories = {
      "単母音": ["section1"],
      "複母音": ["section2"],
      "子音": ["section3", "section5"],
      "鼻母音": ["section6"],
      "声調": ["section4"]
    };
    
    let currentSectionId = "";
    let currentAudio = null;
    let currentQuiz = null;
    
    // ページ切替処理
    function showSection(sectionId) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      document.getElementById(sectionId).classList.add('active');
      currentSectionId = sectionId;
      if (sectionId === 'section11') {
        generateSummaryTable();
      }
    }
    
    function backHome() {
      showSection('home');
      currentSectionId = "";
    }
    
    // 共通のピンインクリック処理
    function attachPinyinClickListener(elem) {
      elem.addEventListener('click', function() {
        const soundName = this.getAttribute('data-sound');
        if (currentAudio && currentAudio.currentButton === this && !currentAudio.paused) {
          currentAudio.pause();
          currentAudio.currentTime = 0;
          currentAudio.currentButton = null;
          return;
        }
        if (currentAudio && !currentAudio.paused) {
          currentAudio.pause();
          currentAudio.currentTime = 0;
        }
        currentAudio = new Audio('sound/' + soundName + '.mp3');
        currentAudio.currentButton = this;
        currentAudio.play();
      });
    }
    
    document.querySelectorAll('.pinyin').forEach(elem => {
      attachPinyinClickListener(elem);
    });
    
    // 再生ボタン用の関数
    function playSound(filename) {
      var audio = new Audio('sound/' + filename + '.mp3');
      audio.play();
    }
    
    // クイズ処理：keepQuestionがtrueなら同じ問題を維持
    function startQuiz(keepQuestion) {
      if (!currentSectionId || !unitQuizData[currentSectionId]) return;
      const currentSection = document.getElementById(currentSectionId);
      const quizSection = currentSection.querySelector('.quiz-section');
      const instructions = quizSection.querySelector('.quiz-instructions');
      if (instructions) instructions.style.display = "none";
      const quizOptionsDiv = quizSection.querySelector('.quiz-options');
      const quizResultP = quizSection.querySelector('.quiz-result');
      
      quizResultP.innerText = "";
      const data = unitQuizData[currentSectionId];
      if (!keepQuestion) {
        const randomIndex = Math.floor(Math.random() * data.length);
        currentQuiz = data[randomIndex];
      }
      
      if (currentAudio && !currentAudio.paused) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
      }
      currentAudio = new Audio('sound/' + currentQuiz + '.mp3');
      currentAudio.play();
      
      let options = [currentQuiz];
      while (options.length < 4) {
        const opt = data[Math.floor(Math.random() * data.length)];
        if (!options.includes(opt)) options.push(opt);
      }
      options.sort(() => 0.5 - Math.random());
      
      quizOptionsDiv.innerHTML = "";
      options.forEach(option => {
        const btn = document.createElement('button');
        btn.innerText = option;
        btn.onclick = function() {
          if (option === currentQuiz) {
            const encouragements = ["素晴らしい！", "その調子！", "よくできました！", "お見事です！"];
            const encouragement = encouragements[Math.floor(Math.random() * encouragements.length)];
            quizResultP.innerText = encouragement;
            setTimeout(() => { startQuiz(false); }, 2000);
          } else {
            quizResultP.innerText = "残念、正解は " + currentQuiz + " です。もう一度挑戦してください。";
            setTimeout(() => { startQuiz(true); }, 2000);
          }
        };
        quizOptionsDiv.appendChild(btn);
      });
    }
    
    // セクション11用：ピンインまとめ（カテゴリ別）
    function generateSummaryTable() {
      let tableHTML = "";
      const columns = 5;
      for (const [category, sections] of Object.entries(summaryCategories)) {
        let combined = [];
        sections.forEach(sectionId => {
          if (unitQuizData[sectionId]) combined = combined.concat(unitQuizData[sectionId]);
        });
        combined = Array.from(new Set(combined));
        tableHTML += `<tr class="category-header"><td colspan="${columns}">${category}</td></tr>`;
        for (let i = 0; i < combined.length; i += columns) {
          tableHTML += "<tr>";
          for (let j = i; j < i + columns; j++) {
            if (combined[j]) {
              tableHTML += `<td><span class="pinyin" data-sound="${combined[j]}">${combined[j]}</span></td>`;
            } else {
              tableHTML += "<td></td>";
            }
          }
          tableHTML += "</tr>";
        }
      }
      document.getElementById("pinyinSummaryBody").innerHTML = tableHTML;
      document.querySelectorAll("#pinyinSummaryBody .pinyin").forEach(elem => {
        attachPinyinClickListener(elem);
      });
    }
  </script>
</body>
</html>
